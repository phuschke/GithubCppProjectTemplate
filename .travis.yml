language: cpp
sudo: required
dist: trusty

os: linux

env:
  global:
    - CI_TARGET=test
    - BUILD_DIR="$TRAVIS_BUILD_DIR/build"

jobs:
  include:
    - stage: build
      compiler: g++
      env: CMAKE_FLAGS = "-DCMAKE_BUILD_TYPE=Release"
    - env: CMAKE_FLAGS = "-DCMAKE_BUILD_TYPE=Debug"
    - stage: lint
      env: CI_TARGET=lint
  allow_failures:
    - env: CI_TARGET=lint
  fast_finish: true

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
      - llvm-toolchain-trusty-4.0
    packages:
      - lcov
      - llvm-4.0-dev
      - clang-4.0

script: sudo ci/script.sh
